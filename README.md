# PythonCompiler - EXE打包工具

PythonCompiler 是一个基于 PyInstaller 的图形化打包工具，帮助用户轻松将 Python 脚本或项目打包成 Windows 可执行文件（.exe）。

## ✨ 主要特性

- 🎯 **图形化界面**：简单易用的 GUI，无需记忆复杂命令
- 📦 **两种打包模式**：支持单文件打包和整个项目目录打包
- 🔄 **自动依赖管理**：自动检查并安装 PyInstaller 及依赖库
- 📚 **依赖库自动安装**：打包前自动安装项目所需的依赖库
- 🎨 **灵活配置**：支持自定义图标、程序名称、输出目录等
- 📊 **实时日志**：实时显示打包过程和日志信息
- 🚀 **智能识别**：目录模式下自动查找主入口文件

## 📋 系统要求

- Windows 操作系统
- Python 3.6 或更高版本
- 网络连接（用于自动安装依赖库）

## 🔧 安装

### 方式一：使用已编译的 EXE（推荐）

直接运行 `PythonCompiler.exe`，无需安装 Python 环境。

### 方式二：从源码运行

1. **克隆或下载项目**

2. **安装依赖**

程序启动时会自动检查并安装以下默认库（如果未安装会自动安装）：
- `pyinstaller` - 主要打包工具
- `setuptools` - Python 打包和分发工具
- `wheel` - Python 二进制包构建工具
- `pefile` - PyInstaller 依赖：用于处理 PE 文件
- `altgraph` - PyInstaller 依赖：图形算法库
- `pyinstaller-hooks-contrib` - PyInstaller 钩子扩展

也可以手动安装：

```bash
pip install -r requirements.txt
```

或直接安装 PyInstaller：

```bash
pip install pyinstaller
```

3. **运行程序**

```bash
python pyinstaller_gui.py
```

## 🚀 使用方法

### 启动程序

运行 `PythonCompiler.exe` 或执行 `python pyinstaller_gui.py`

### 打包模式

#### 模式一：单文件打包

适用于单个 Python 脚本文件。

1. 选择打包模式：**单个文件**
2. 点击"浏览"选择 Python 脚本文件（.py）
3. 配置其他选项（可选）
4. 点击"开始打包"

#### 模式二：目录打包

适用于包含多个文件的 Python 项目。

1. 选择打包模式：**整个目录**
2. 点击"浏览"选择项目目录
3. 指定主入口文件（程序会自动查找 `main.py`、`__main__.py`、`app.py`、`run.py`）
4. 配置其他选项（可选）
5. 点击"开始打包"

**目录模式特点**：
- 自动包含项目目录中的所有 Python 文件
- 自动包含项目目录中的数据文件
- 自动识别并打包项目模块
- 排除常见非打包目录（`.git`、`__pycache__`、`venv`、`dist`、`build` 等）

### 基本配置

- **Python 脚本/项目目录**：选择要打包的 Python 文件或项目目录
- **主入口文件**（仅目录模式）：指定项目的入口 Python 文件
- **输出目录**：指定打包后 exe 文件的保存位置（默认：脚本所在目录）
- **图标文件**：选择 .ico 格式的图标文件（可选）
- **程序名称**：设置生成的 exe 文件名（默认：脚本文件名）

### 依赖库管理

1. 在"依赖库管理"区域的文本框中输入需要安装的库名称
2. 支持多种输入方式：
   - **逗号分隔**：`requests, numpy, pandas`
   - **换行分隔**：每行一个库名
   - **混合使用**：可以同时使用逗号和换行
3. **自动安装选项**：
   - 勾选"打包前自动安装依赖库"（默认启用）：打包时会自动先安装所有依赖库
   - 点击"立即安装"按钮：可以单独安装依赖库，不进行打包

**示例输入**：
```
requests
numpy, pandas
matplotlib
```

### 打包选项

- **单文件模式 (--onefile)**：生成单个 exe 文件，所有依赖都打包在一起
  - ✅ 启用：生成单个 exe 文件（推荐）
  - ❌ 禁用：生成一个文件夹，包含 exe 和依赖文件

- **窗口模式 (--windowed)**：控制是否显示控制台窗口
  - ✅ 启用：无控制台窗口，适合 GUI 程序
  - ❌ 禁用：显示控制台窗口，适合命令行程序

- **清理临时文件 (--clean)**：打包前是否清理之前的临时文件
  - ✅ 启用：清理临时文件（推荐，确保干净打包）
  - ❌ 禁用：保留临时文件（可能加快后续打包速度）

### 打包日志

- 实时显示打包过程的详细日志
- 包括依赖库安装日志和 PyInstaller 打包日志
- 可以点击"清空日志"按钮清除日志内容

## 📁 输出位置

打包完成后，exe 文件会生成在：

- 如果指定了输出目录：`<输出目录>/<程序名称>.exe`
- 如果未指定输出目录：`<脚本所在目录>/dist/<程序名称>.exe`

## ⚠️ 注意事项

1. **默认库自动安装**
   - 程序启动时（仅开发环境）会自动检查并安装必要的默认库
   - 如果检测到缺少默认库，会自动尝试安装
   - 需要网络连接才能自动安装

2. **图标文件**
   - 图标文件必须是 `.ico` 格式
   - 建议使用在线工具将 PNG/JPG 转换为 ICO 格式

3. **依赖库**
   - 工具支持自动安装依赖库，只需输入库名称即可
   - 也可以手动安装：`pip install <库名>`
   - **强烈建议使用虚拟环境**以避免污染系统 Python 环境

4. **文件大小**
   - 单文件模式生成的 exe 文件会比较大（通常几十到几百 MB）
   - 这是因为包含了 Python 解释器和所有依赖库
   - 这是正常现象，不是程序错误

5. **杀毒软件**
   - 某些杀毒软件可能会误报打包后的 exe 文件
   - 这是正常现象，因为 PyInstaller 打包的程序可能触发启发式检测
   - 可以将 exe 文件添加到杀毒软件白名单

6. **网络连接**
   - 自动安装依赖库需要网络连接
   - 确保能访问 PyPI（Python Package Index）

7. **目录模式限制**
   - 主入口文件必须在项目目录内
   - 程序会自动验证主入口文件的位置

## ❓ 常见问题

### Q: 打包后的 exe 文件很大？

**A:** 这是正常的，PyInstaller 会打包 Python 解释器和所有依赖。可以通过以下方式减小文件大小：
- 使用虚拟环境，只安装必要的依赖
- 使用 `--exclude-module` 排除不需要的模块（需要修改代码）
- 考虑使用非单文件模式（`--no-onefile`）

### Q: 打包后运行报错？

**A:** 请检查以下几点：
- 是否所有依赖都已正确安装
- 查看打包日志中的警告信息
- 检查是否有缺失的数据文件或资源文件
- 尝试使用非单文件模式，查看具体错误信息

### Q: 如何打包包含数据文件的项目？

**A:** 使用目录模式打包，程序会自动包含项目目录中的所有文件。如果仍有文件缺失，可能需要手动添加 `--add-data` 参数（需要修改代码）。

### Q: 支持哪些 Python 版本？

**A:** 支持 Python 3.6 及更高版本。建议使用 Python 3.8 或更高版本以获得更好的兼容性。

### Q: 可以在 Linux 或 macOS 上使用吗？

**A:** 当前版本主要针对 Windows 平台设计。虽然 PyInstaller 支持跨平台，但本工具的某些功能（如窗口图标设置）可能在其他平台上表现不同。

### Q: 打包失败怎么办？

**A:** 
1. 查看日志区域的详细错误信息
2. 确保所有依赖库都已正确安装
3. 检查 Python 脚本是否有语法错误
4. 尝试使用非单文件模式进行打包
5. 确保有足够的磁盘空间

## 📝 项目信息

- **项目名称**：PythonCompiler
- **版本**：1.0.0
- **开发者**：JMTechPower
- **许可证**：MIT License

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

## 📄 许可证

MIT License

---

**提示**：如果遇到问题，请查看打包日志中的详细信息，或提交 Issue 寻求帮助。
